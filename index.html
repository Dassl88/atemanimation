<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Rauchfrei App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      background-color: #121212;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding-bottom: 100px;
    }
    nav {
      background-color: #1f1f1f;
      display: flex;
      justify-content: space-around;
      padding: 10px 0;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    nav a {
      color: white;
      text-decoration: none;
      padding: 10px 20px;
      border-radius: 5px;
    }
    nav a.active-nav {
      background-color: green;
    }
    .section {
      display: none;
      padding: 20px;
    }
    .section.active {
      display: block;
    }
    .circle {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: conic-gradient(green 0%, #444 0%);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 10px auto;
      font-weight: bold;
      font-size: 16px;
    }
    .stat-box {
      background: #1f1f1f;
      margin: 10px auto;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      width: 80%;
    }
    .health-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .health-item {
      text-align: center;
    }
    #userDataForm {
      background: #1f1f1f;
      padding: 20px;
      border-radius: 8px;
      max-width: 400px;
      margin: 20px auto;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 6px;
      font-weight: bold;
    }
    .form-group input {
      width: 100%;
      padding: 8px;
      border-radius: 6px;
      border: none;
      background-color: #2c2c2c;
      color: white;
      font-size: 1rem;
    }
    #userDataForm button {
      width: 100%;
      padding: 10px;
      font-size: 1rem;
      background-color: green;
      color: white;
      border: none;
      border-radius: 6px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
<nav>
  <a href="#" class="active-nav" onclick="showSection('dashboard')">Dashboard</a>
  <a href="#" onclick="showSection('meilensteine')">Meilensteine</a>
  <a href="#" onclick="showSection('daten')">Meine Daten</a>
</nav>

<section id="dashboard" class="section active">
  <h2 style="text-align:center;">Willkommen <span id="userNameDisplay">üë§</span></h2>
  <p style="text-align:center;" id="motivationSpruch">Motivationsspruch erscheint hier</p>
  <div class="stat-box" id="zeitBox">‚è≥ Rauchfrei seit: ...</div>
  <div class="stat-box" id="zigBox">üö≠ Nicht gerauchte Zigaretten: ...</div>
  <div class="stat-box" id="geldBox">üí∞ Gespartes Geld: ...</div>
  <div class="stat-box" id="lebenBox">‚ù§Ô∏è Gewonnene Lebenszeit: ...</div>

  <h3 style="text-align:center; margin-top: 40px;">Wiedererlangte Gesundheit</h3>
  <div class="health-grid">
    <div class="health-item">
      <strong>Kurzfristig</strong><br />
      <small>1 Min ‚Äì 1 Woche</small>
      <div class="circle" id="shortHealth">0%</div>
    </div>
    <div class="health-item">
      <strong>Mittelfristig</strong><br />
      <small>1 ‚Äì 6 Wochen</small>
      <div class="circle" id="midHealth">0%</div>
    </div>
    <div class="health-item">
      <strong>Langfristig</strong><br />
      <small>6 Wochen ‚Äì 1 Jahr</small>
      <div class="circle" id="longHealth">0%</div>
    </div>
    <div class="health-item">
      <strong>Sehr langfristig</strong><br />
      <small>1 Jahr ‚Äì 15 Jahre</small>
      <div class="circle" id="veryHealth">0%</div>
    </div>
  </div>
</section>
<section id="daten" class="section">
  <h2 style="text-align:center;">Meine Daten</h2>
  <form id="userDataForm">
    <div class="form-group">
      <label for="name">Name:</label>
      <input type="text" id="name" name="name" required>
    </div>
    <div class="form-group">
      <label for="quitDate">Aufh√∂rdatum:</label>
      <input type="date" id="quitDate" name="quitDate" required>
    </div>
    <div class="form-group">
      <label for="quitTime">Uhrzeit:</label>
      <input type="time" id="quitTime" name="quitTime" required>
    </div>
    <div class="form-group">
      <label for="cigsPerDay">Zigaretten pro Tag:</label>
      <input type="number" id="cigsPerDay" name="cigsPerDay" required>
    </div>
    <div class="form-group">
      <label for="cigsPerPack">Zigaretten pro Schachtel:</label>
      <input type="number" id="cigsPerPack" name="cigsPerPack" required>
    </div>
    <div class="form-group">
      <label for="packPrice">Preis pro Schachtel (‚Ç¨):</label>
      <input type="number" step="0.01" id="packPrice" name="packPrice" required>
    </div>
    <div class="form-group">
      <label for="age">Alter:</label>
      <input type="number" id="age" name="age">
    </div>
    <div class="form-group">
      <label for="yearsSmoked">Jahre geraucht:</label>
      <input type="number" id="yearsSmoked" name="yearsSmoked">
    </div>
    <button type="submit">Daten speichern</button>
  </form>
</section>
<section id="meilensteine" class="section">
  <h2 style="text-align:center;">Meilensteine</h2>
  <div id="milestoneList" style="max-width: 800px; margin: auto;"></div>
</section>
<script>
  function showSection(id) {
    document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    document.querySelectorAll("nav a").forEach(a => a.classList.remove("active-nav"));
    document.querySelector(`nav a[onclick*="${id}"]`).classList.add("active-nav");
  }

  function updateLiveTimer(startDate) {
    function refresh() {
      const jetzt = new Date();
      const diff = jetzt - startDate;
      const sek = Math.floor(diff / 1000);
      const tage = Math.floor(sek / 86400);
      const stunden = Math.floor((sek % 86400) / 3600);
      const minuten = Math.floor((sek % 3600) / 60);
      const sekunden = sek % 60;
      const text = `‚è≥ Rauchfrei seit: ${tage} Tage, ${stunden} Std, ${minuten} Min, ${sekunden} Sek`;
      document.getElementById("zeitBox").textContent = text;
    }
    refresh();
    setInterval(refresh, 1000);
  }

  const sprueche = [
    "Heute ist ein guter Tag, um stark zu sein.",
    "Du gewinnst jeden Tag mehr zur√ºck.",
    "Dein K√∂rper sagt Danke.",
    "Freiheit beginnt mit dem ersten Schritt.",
    "Du bist st√§rker als du denkst.",
    "Jede Zigarette, die du nicht rauchst, z√§hlt.",
    "Atme durch ‚Äì frei und klar.",
    "Deine Gesundheit geh√∂rt dir.",
    "Mach weiter ‚Äì du wirst belohnt.",
    "Du bist auf dem richtigen Weg.",
    "Der erste Tag vom Rest deines Lebens.",
    "Du hast heute schon gewonnen.",
    "Es wird jeden Tag leichter.",
    "Sei stolz auf dich.",
    "Du bist ein Vorbild.",
    "Dein Herz schl√§gt freier.",
    "Deine Lunge atmet auf.",
    "Heute bist du ein Held.",
    "Rauchfrei hei√üt Lebensqualit√§t.",
    "Bleib stark ‚Äì es lohnt sich."
  ];

  const form = document.getElementById("userDataForm");
  form.addEventListener("submit", function(e) {
    e.preventDefault();
    const fields = ["name", "quitDate", "quitTime", "cigsPerDay", "cigsPerPack", "packPrice", "age", "yearsSmoked"];
    const userData = {};
    fields.forEach(f => userData[f] = document.getElementById(f).value);
    localStorage.setItem("rauchfreiUserData", JSON.stringify(userData));
    alert("Daten gespeichert!");
    location.reload();
  });
  function loadUserData() {
    const d = JSON.parse(localStorage.getItem("rauchfreiUserData"));
    if (!d || !d.quitDate || !d.quitTime) return null;
    const start = new Date(`${d.quitDate}T${d.quitTime}`);
    const now = new Date();
    const minutes = Math.floor((now - start) / 60000);
    const days = minutes / 1440;
    return { ...d, start, minutes, days };
  }

  function fillDashboard(data) {
    document.getElementById("userNameDisplay").textContent = data.name || "Freund";
    document.getElementById("motivationSpruch").textContent =
      sprueche[Math.floor(Math.random() * sprueche.length)];

    const zigsPerDay = parseFloat(data.cigsPerDay);
    const packs = parseFloat(data.cigsPerPack);
    const price = parseFloat(data.packPrice);
    const zigs = Math.round((zigsPerDay / 1440) * data.minutes);
    const euros = ((zigs / packs) * price).toFixed(2);
    const lifetime = Math.round(zigs * 10); // 10 Minuten pro Zigarette

    document.getElementById("zigBox").textContent = `üö≠ Nicht gerauchte Zigaretten: ${zigs}`;
    document.getElementById("geldBox").textContent = `üí∞ Gespartes Geld: ${euros} ‚Ç¨`;
    document.getElementById("lebenBox").textContent =
      `‚ù§Ô∏è Gewonnene Lebenszeit: ${Math.floor(lifetime / 1440)} Tage ${Math.floor((lifetime % 1440) / 60)} Std`;
  }

  const milestoneData = [
    { title: "Puls und Blutdruck", days: 0.01, desc: "nach 20 Minuten: Puls und Blutdruck sinken auf Normalniveau." },
    { title: "K√∂rpertemperatur reguliert sich", days: 0.02, desc: "nach 30 Minuten: H√§nde und F√º√üe werden besser durchblutet." },
    { title: "Durchblutung verbessert sich", days: 0.08, desc: "nach 2 Stunden: Extremit√§ten werden w√§rmer und besser versorgt." },
    { title: "Sauerstoffgehalt", days: 0.33, desc: "nach 8 Stunden: Sauerstoffgehalt im Blut normalisiert sich." },
    { title: "Erste Entzugserscheinungen", days: 0.5, desc: "nach 12 Stunden: Reizbarkeit und Unruhe treten auf." },
    { title: "Kohlenmonoxidspiegel sinkt", days: 1, desc: "nach 24 Stunden: Kohlenmonoxid wird vollst√§ndig abgebaut." },
    { title: "Mentale Klarheit kehrt zur√ºck", days: 1.5, desc: "nach 36 Stunden: Konzentration verbessert sich." },
    { title: "Geruchssinn verbessert sich", days: 2, desc: "nach 48 Stunden: Geruchssinn funktioniert deutlich besser." },
    { title: "Geschmackssinn kehrt zur√ºck", days: 2, desc: "nach 48 Stunden: Essen schmeckt wieder intensiver." },
    { title: "Nikotinabbau", days: 3, desc: "nach 3 Tagen: Nikotin ist komplett aus dem K√∂rper." },
    { title: "Atemwege beginnen sich zu reinigen", days: 2, desc: "nach 2 Tagen: Lunge transportiert Schleim aktiv ab." },
    { title: "Raucherhusten nimmt zu", days: 3, desc: "nach 3 Tagen: Die Lunge beginnt sich zu reinigen." },
    { title: "Zuckerstoffwechsel stabilisiert sich", days: 5, desc: "nach 5 Tagen: Blutzuckerwerte normalisieren sich." },
    { title: "Besseres Hautbild", days: 7, desc: "nach 1 Woche: Haut sieht frischer aus." },
    { title: "Lungenfunktion verbessert sich deutlich", days: 21, desc: "nach 3 Wochen: Besseres Atemvolumen, weniger Luftnot." },
    { title: "Emotionale Ausgeglichenheit", days: 42, desc: "nach 6 Wochen: Stimmung wird dauerhaft stabil." },
    { title: "Herzinfarktrisiko halbiert", days: 365, desc: "nach 1 Jahr: Risiko halbiert sich im Vergleich zu Rauchern." },
    { title: "Immunsystem auf Top-Niveau", days: 540, desc: "nach 1,5 Jahren: Abwehrkr√§fte wie bei Nichtrauchern." },
    { title: "Lebenserwartung deutlich erh√∂ht", days: 3650, desc: "nach 10 Jahren: Bis zu 10 Jahre mehr Lebenszeit." }
  ];

  function updateHealthCircles(data) {
    const cats = {
      shortHealth: milestoneData.filter(m => m.days < 7),
      midHealth: milestoneData.filter(m => m.days >= 7 && m.days < 42),
      longHealth: milestoneData.filter(m => m.days >= 42 && m.days <= 365),
      veryHealth: milestoneData.filter(m => m.days > 365)
    };
    for (let id in cats) {
      const list = cats[id];
      const avg = list.length
        ? Math.round(list.map(m => Math.min(100, data.days / m.days * 100)).reduce((a, b) => a + b, 0) / list.length)
        : 0;
      const el = document.getElementById(id);
      el.innerHTML = `${avg}%`;
      el.style.background = `conic-gradient(green ${avg}%, #444 ${avg}%)`;
    }
  }
  function renderMilestones(data) {
    const container = document.getElementById("milestoneList");
    container.innerHTML = "";
    const groups = {
      "Kurzfristig": milestoneData.filter(m => m.days < 7),
      "Mittelfristig": milestoneData.filter(m => m.days >= 7 && m.days < 42),
      "Langfristig": milestoneData.filter(m => m.days >= 42 && m.days <= 365),
      "Sehr langfristig": milestoneData.filter(m => m.days > 365)
    };

    for (let cat in groups) {
      const groupBox = document.createElement("div");
      const header = document.createElement("h3");
      header.innerText = cat;
      header.style.textAlign = "center";
      header.style.fontSize = "1.4rem";
      header.style.marginTop = "40px";
      header.style.background = "#2b7a78";
      header.style.color = "#fff";
      header.style.padding = "10px";
      header.style.borderRadius = "6px";
      groupBox.appendChild(header);

      groups[cat].forEach(m => {
        const percent = Math.min(100, Math.round((data.days / m.days) * 100));
        const box = document.createElement("div");
        box.className = "milestone";
        box.style.margin = "20px 0";
        box.style.padding = "10px";
        box.style.border = "1px solid #333";
        box.style.borderRadius = "10px";
        box.style.textAlign = "center";
        box.style.background = "#1c1c1c";

        box.innerHTML = `
          <h4 style="font-weight: bold;">${m.title}</h4>
          <div class="circle" style="background: conic-gradient(green ${percent}%, #444 ${percent}%);">${percent}%</div>
          <p style="margin-top: 8px;">${m.desc}</p>`;
        groupBox.appendChild(box);
      });

      container.appendChild(groupBox);
    }
  }
  window.onload = () => {
    const data = loadUserData();
    if (data) {
      fillDashboard(data);
      renderMilestones(data);
      updateHealthCircles(data);
      updateLiveTimer(new Date(data.start));
      for (let key in data) {
        if (document.getElementById(key)) {
          document.getElementById(key).value = data[key];
        }
      }
    }
  };
</script>
</body>
</html>
