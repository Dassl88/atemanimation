<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rauchfrei App</title>
  <style>
    body {
      background-color: #121212;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0 0 100px 0;
    }
    nav {
      background-color: #1f1f1f;
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    nav a {
      color: white;
      text-decoration: none;
      padding: 10px 20px;
      border-radius: 5px;
    }
    nav a.active-nav {
      background-color: green;
    }
    .section {
      display: none;
      padding: 20px;
    }
    .section.active {
      display: block;
    }
    .stat-box {
      background: #1f1f1f;
      margin: 10px auto;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      width: 80%;
    }
    .health-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .health-item {
      text-align: center;
    }
    .circle {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: conic-gradient(green 0%, #444 0%);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 10px auto;
      font-weight: bold;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <nav>
    <a href="#" class="active-nav" onclick="showSection('dashboard')">Dashboard</a>
    <a href="#" onclick="showSection('meilensteine')">Meilensteine</a>
    <a href="#" onclick="showSection('daten')">Meine Daten</a>
  </nav>

  <section id="dashboard" class="section active">
    <h2 style="text-align:center;">Willkommen <span id="userNameDisplay">üë§</span></h2>
    <p style="text-align:center;" id="motivationSpruch">Du schaffst das! üöÄ</p>

    <div class="stat-box" id="zeitBox">‚è≥ Rauchfrei seit: ...</div>
    <div class="stat-box" id="zigBox">üö≠ Nicht gerauchte Zigaretten: ...</div>
    <div class="stat-box" id="geldBox">üí∞ Gespartes Geld: ...</div>
    <div class="stat-box" id="lebenBox">‚ù§Ô∏è Gewonnene Lebenszeit: ...</div>

    <h3 style="text-align:center; margin-top: 40px;">Wiedererlangte Gesundheit</h3>
    <div class="health-grid">
      <div class="health-item">
        <strong>Kurzfristig</strong><br />
        <small>1 Min ‚Äì 1 Woche</small>
        <div class="circle" id="shortHealth">0%</div>
      </div>
      <div class="health-item">
        <strong>Mittelfristig</strong><br />
        <small>1 ‚Äì 6 Wochen</small>
        <div class="circle" id="midHealth">0%</div>
      </div>
      <div class="health-item">
        <strong>Langfristig</strong><br />
        <small>6 Wochen ‚Äì 1 Jahr</small>
        <div class="circle" id="longHealth">0%</div>
      </div>
      <div class="health-item">
        <strong>Sehr langfristig</strong><br />
        <small>1 Jahr ‚Äì 15 Jahre</small>
        <div class="circle" id="veryHealth">0%</div>
      </div>
    </div>

    <h3 style="text-align:center; margin-top: 40px;">Suchtdruck Verlauf</h3>

    <div style="width: 80%; margin: 15px auto;">
      <strong>Kurzfristige Entw√∂hnung (14 Tage)</strong>
      <div style="background: #444; border-radius: 20px; overflow: hidden; height: 25px; margin-top: 5px;">
        <div id="kurzSucht" style="height: 100%; width: 0%; background: linear-gradient(to right, red, orange, yellow, green); text-align: center; color: black; font-weight: bold;">
          0%
        </div>
      </div>
    </div>

    <div style="width: 80%; margin: 15px auto;">
      <strong>Langfristiger Suchtdruck (5 Jahre)</strong>
      <div style="background: #444; border-radius: 20px; overflow: hidden; height: 25px; margin-top: 5px;">
        <div id="langSucht" style="height: 100%; width: 0%; background: linear-gradient(to right, orange, yellow, green); text-align: center; color: black; font-weight: bold;">
          0%
        </div>
      </div>
    </div>
  </section>
<section id="daten" class="section">
  <h2 style="text-align:center;">Meine Daten</h2>
  <form id="userDataForm" style="max-width: 400px; margin: 0 auto; background: #1f1f1f; padding: 20px; border-radius: 10px;">
    <div style="margin-bottom: 15px;">
      <label for="name">Name:</label>
      <input type="text" id="name" name="name" required style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
    </div>
    <div style="margin-bottom: 15px;">
      <label for="quitDate">Aufh√∂rdatum:</label>
      <input type="date" id="quitDate" name="quitDate" required style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
    </div>
    <div style="margin-bottom: 15px;">
      <label for="quitTime">Uhrzeit:</label>
      <input type="time" id="quitTime" name="quitTime" required style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
    </div>
    <div style="margin-bottom: 15px;">
      <label for="cigsPerDay">Zigaretten pro Tag:</label>
      <input type="number" id="cigsPerDay" name="cigsPerDay" required style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
    </div>
    <div style="margin-bottom: 15px;">
      <label for="cigsPerPack">Zigaretten pro Schachtel:</label>
      <input type="number" id="cigsPerPack" name="cigsPerPack" required style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
    </div>
    <div style="margin-bottom: 15px;">
      <label for="packPrice">Preis pro Schachtel (‚Ç¨):</label>
      <input type="number" step="0.01" id="packPrice" name="packPrice" required style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
    </div>
    <div style="margin-bottom: 15px;">
      <label for="age">Alter:</label>
      <input type="number" id="age" name="age" style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
    </div>
    <div style="margin-bottom: 15px;">
      <label for="yearsSmoked">Jahre geraucht:</label>
      <input type="number" id="yearsSmoked" name="yearsSmoked" style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
    </div>
    <button type="submit" style="width: 100%; padding: 10px; font-size: 1rem; background-color: green; color: white; border: none; border-radius: 5px;">
      Daten speichern
    </button>
  </form>
</section>
<section id="meilensteine" class="section">
  <h2 style="text-align:center;">Meilensteine</h2>
  <div id="milestoneList" style="max-width: 800px; margin: auto;"></div>
</section>
<script>
function showSection(id) {
  document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll("nav a").forEach(a => a.classList.remove("active-nav"));
  document.querySelector(`nav a[onclick*="${id}"]`).classList.add("active-nav");
}

const sprueche = [
  "Heute ist ein guter Tag, um stark zu sein.",
  "Du gewinnst jeden Tag mehr zur√ºck.",
  "Dein K√∂rper sagt Danke.",
  "Freiheit beginnt mit dem ersten Schritt.",
  "Du bist st√§rker als du denkst.",
  "Jede Zigarette, die du nicht rauchst, z√§hlt.",
  "Atme durch ‚Äì frei und klar.",
  "Deine Gesundheit geh√∂rt dir.",
  "Mach weiter ‚Äì du wirst belohnt.",
  "Du bist auf dem richtigen Weg.",
  "Der erste Tag vom Rest deines Lebens.",
  "Du hast heute schon gewonnen.",
  "Es wird jeden Tag leichter.",
  "Sei stolz auf dich.",
  "Du bist ein Vorbild.",
  "Dein Herz schl√§gt freier.",
  "Deine Lunge atmet auf.",
  "Heute bist du ein Held.",
  "Rauchfrei hei√üt Lebensqualit√§t.",
  "Bleib stark ‚Äì es lohnt sich."
];

document.getElementById("userDataForm").addEventListener("submit", function(e) {
  e.preventDefault();
  const fields = ["name", "quitDate", "quitTime", "cigsPerDay", "cigsPerPack", "packPrice", "age", "yearsSmoked"];
  const userData = {};
  fields.forEach(f => userData[f] = document.getElementById(f).value);
  localStorage.setItem("rauchfreiUserData", JSON.stringify(userData));
  alert("Daten gespeichert!");
  location.reload();
});

function loadUserData() {
  const d = JSON.parse(localStorage.getItem("rauchfreiUserData"));
  if (!d || !d.quitDate || !d.quitTime) return null;
  const start = new Date(`${d.quitDate}T${d.quitTime}`);
  const now = new Date();
  const minutes = Math.floor((now - start) / 60000);
  const days = minutes / 1440;
  return { ...d, start, minutes, days };
}
function fillDashboard(data) {
  document.getElementById("userNameDisplay").textContent = data.name || "Freund";
  document.getElementById("motivationSpruch").textContent =
    sprueche[Math.floor(Math.random() * sprueche.length)];

  const zigsPerDay = parseFloat(data.cigsPerDay);
  const packs = parseFloat(data.cigsPerPack);
  const price = parseFloat(data.packPrice);
  const zigs = Math.round((zigsPerDay / 1440) * data.minutes);
  const euros = ((zigs / packs) * price).toFixed(2);
  const lifetime = Math.round(zigs * 10); // 10 Minuten pro Zigarette

  document.getElementById("zeitBox").textContent = `‚è≥ Rauchfrei seit: ${Math.floor(data.days)} Tage`;
  document.getElementById("zigBox").textContent = `üö≠ Nicht gerauchte Zigaretten: ${zigs}`;
  document.getElementById("geldBox").textContent = `üí∞ Gespartes Geld: ${euros} ‚Ç¨`;
  document.getElementById("lebenBox").textContent = `‚ù§Ô∏è Gewonnene Lebenszeit: ${Math.floor(lifetime / 1440)} Tage ${Math.floor((lifetime % 1440) / 60)} Std`;

  const kurzMax = 14;
  const kurzProgress = Math.min(100, Math.round((data.days / kurzMax) * 100));
  const kurzBar = document.getElementById("kurzSucht");
  kurzBar.style.width = `${kurzProgress}%`;
  kurzBar.textContent = `${kurzProgress}%`;

  const langMax = 1825;
  const langProgress = Math.min(100, Math.round((data.days / langMax) * 100));
  const langBar = document.getElementById("langSucht");
  langBar.style.width = `${langProgress}%`;
  langBar.textContent = `${langProgress}%`;
}

function updateHealthCircles(data) {
  const cats = {
    shortHealth: milestoneData.filter(m => m.days < 7),
    midHealth: milestoneData.filter(m => m.days >= 7 && m.days < 42),
    longHealth: milestoneData.filter(m => m.days >= 42 && m.days <= 365),
    veryHealth: milestoneData.filter(m => m.days > 365)
  };

  for (let id in cats) {
    const list = cats[id];
    const avg = list.length
      ? Math.round(list.map(m => Math.min(100, data.days / m.days * 100)).reduce((a, b) => a + b, 0) / list.length)
      : 0;
    const el = document.getElementById(id);
    el.innerHTML = `${avg}%`;
    el.style.background = `conic-gradient(green ${avg}%, #444 ${avg}%)`;
  }
}
const milestoneData = [
  { title: "Puls und Blutdruck", days: 0.01, desc: "üïí Nach 20 Minuten: Puls und Blutdruck sinken auf Normalniveau." },
  { title: "K√∂rpertemperatur reguliert sich", days: 0.02, desc: "üïí Nach 30 Minuten: H√§nde und F√º√üe werden besser durchblutet." },
  { title: "Sauerstoffgehalt", days: 0.33, desc: "üïí Nach 8 Stunden: Sauerstoffgehalt im Blut normalisiert sich." },
  { title: "Kohlenmonoxidspiegel sinkt", days: 1, desc: "üïí Nach 24 Stunden: Kohlenmonoxid wird abgebaut." },
  { title: "Nikotinabbau", days: 3, desc: "üïí Nach 2‚Äì3 Tagen: Nikotin ist vollst√§ndig abgebaut." },
  { title: "Mentale Klarheit kehrt zur√ºck", days: 3, desc: "üïí Nach 3 Tagen: Konzentration verbessert sich." },
  { title: "1 Woche rauchfrei", days: 7, desc: "üïí Tag 7: R√ºckfallgefahr sinkt deutlich." },
  { title: "Lungenfunktion verbessert sich", days: 21, desc: "üïí Nach 3 Wochen: Sp√ºrbar mehr Luft beim Atmen." },
  { title: "Husten l√§sst nach", days: 28, desc: "üïí Nach 4 Wochen: Reizhusten verschwindet." },
  { title: "Herzinfarktrisiko halbiert", days: 365, desc: "üïí Nach 1 Jahr: Risiko halbiert sich." },
  { title: "Schlaganfallrisiko sinkt", days: 1825, desc: "üïí Nach 5 Jahren: Risiko auf Niveau von Nichtrauchern." }
  // Du kannst hier gerne ALLE Meilensteine aus deiner Liste erg√§nzen
];

function renderMilestones(data) {
  const container = document.getElementById("milestoneList");
  container.innerHTML = "";

  const groups = {
    "Kurzfristig": milestoneData.filter(m => m.days < 7),
    "Mittelfristig": milestoneData.filter(m => m.days >= 7 && m.days < 42),
    "Langfristig": milestoneData.filter(m => m.days >= 42 && m.days <= 365),
    "Sehr langfristig": milestoneData.filter(m => m.days > 365)
  };

  for (let cat in groups) {
    const groupBox = document.createElement("div");
    groupBox.innerHTML = `<h3 style="text-align:center;">${cat}</h3>`;

    groups[cat].forEach(m => {
      const percent = Math.min(100, Math.round((data.days / m.days) * 100));
      const box = document.createElement("div");
      box.style = "margin: 20px; padding: 10px; background: #1c1c1c; border-radius: 10px; text-align: center;";
      box.innerHTML = `
        <h4>${m.title}</h4>
        <div class="circle" style="background: conic-gradient(green ${percent}%, #444 ${percent}%);">${percent}%</div>
        <p>${m.desc}</p>
      `;
      groupBox.appendChild(box);
    });

    container.appendChild(groupBox);
  }
}

window.onload = () => {
  const data = loadUserData();
  if (data) {
    fillDashboard(data);
    updateHealthCircles(data);
    renderMilestones(data);
    for (let key in data) {
      if (document.getElementById(key)) {
        document.getElementById(key).value = data[key];
      }
    }
  }
};
</script>
</body>
</html>
