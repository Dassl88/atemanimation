<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Rauchfrei Tracker Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      margin: 0;
      padding: 20px;
      background-color: #111;
      font-family: Arial, sans-serif;
      color: white;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    .input-block {
      text-align: center;
      margin-bottom: 30px;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 5px;
      border-radius: 8px;
      border: none;
    }
    button {
      background-color: #10b981;
      color: white;
      cursor: pointer;
    }
    .button-reset {
      background-color: #ef4444;
    }
    .grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }
    .reel {
      background: #222;
      border-radius: 16px;
      padding: 20px;
      width: 250px;
      text-align: center;
    }
    .progress-circle {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: conic-gradient(#10b981 0%, #333 0%);
      margin: 10px auto;
      position: relative;
    }
    .progress-circle span {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 18px;
      color: white;
    }
    .info-box {
      background: #111;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 30px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    .milestone-title {
      font-weight: bold;
      margin-top: 10px;
    }
    .milestone-description {
      margin-top: 5px;
    }
    .milestone-status {
      margin-top: 5px;
      color: #10b981;
    }
    .category-title {
      font-size: 20px;
      margin-top: 30px;
      text-align: center;
    }
  </style>
</head>
<body>

  <h1>üö≠ Rauchfrei Tracker Pro</h1>

  <!-- Hauptbuttons -->
  <div class="input-block">
    <button onclick="toggleSettings()">‚öôÔ∏è Einstellungen</button>
    <button onclick="showProgress()">üìä Fortschritt anzeigen</button>
    <button onclick="resetData()" class="button-reset">Daten zur√ºcksetzen</button>
  </div>

  <!-- Einstellungsbereich -->
  <div id="settingsPanel" class="input-block" style="display: none;">
    <h2>Einstellungen</h2>
    <label>Aufh√∂rdatum & Uhrzeit:</label><br />
    <input type="datetime-local" id="quitDate" /><br />
    <label>Zigaretten pro Tag:</label><br />
    <input type="number" id="cigsPerDay" /><br />
    <label>Preis pro Schachtel (‚Ç¨):</label><br />
    <input type="number" id="packPrice" step="0.01" /><br />
    <label>Zigaretten pro Schachtel:</label><br />
    <input type="number" id="cigsPerPack" /><br />
    <label>Alter:</label><br />
    <input type="number" id="age" /><br />
    <label>Gerauchte Jahre:</label><br />
    <input type="number" id="yearsSmoked" /><br />
  </div>

  <div id="info" class="info-box"></div>
  <div id="reels" class="grid"></div>

  <script>
    function toggleSettings() {
      const panel = document.getElementById("settingsPanel");
      panel.style.display = panel.style.display === "none" ? "block" : "none";
    }

    function loadSettings() {
      const fields = ["quitDate", "cigsPerDay", "packPrice", "cigsPerPack", "age", "yearsSmoked"];
      fields.forEach(id => {
        const saved = localStorage.getItem(id);
        if (saved !== null) document.getElementById(id).value = saved;
        document.getElementById(id).addEventListener("input", () => {
          localStorage.setItem(id, document.getElementById(id).value);
        });
      });
    }

    window.onload = loadSettings;

    function resetData() {
      localStorage.clear();
      location.reload();
    }

    function showProgress() {
      const quitInput = localStorage.getItem("quitDate");
      const cigsPerDay = parseInt(localStorage.getItem("cigsPerDay"));
      const packPrice = parseFloat(localStorage.getItem("packPrice"));
      const cigsPerPack = parseInt(localStorage.getItem("cigsPerPack"));
      const age = parseInt(localStorage.getItem("age"));
      const yearsSmoked = parseInt(localStorage.getItem("yearsSmoked"));

      if (!quitInput || isNaN(cigsPerDay) || isNaN(packPrice) || isNaN(cigsPerPack) || isNaN(age) || isNaN(yearsSmoked)) {
        alert("Bitte f√ºlle die Einstellungen aus!");
        return;
      }

      const quitTime = new Date(quitInput);
      const now = new Date();
      const diffHours = (now - quitTime) / 1000 / 60 / 60;
      const diffDays = diffHours / 24;
      const diffMonths = diffDays / 30;
      const diffYears = diffDays / 365;

      const totalCigsAvoided = Math.floor(cigsPerDay * diffDays);
      const totalMoneySaved = ((totalCigsAvoided / cigsPerPack) * packPrice).toFixed(2);
      const lifeRegainedMin = totalCigsAvoided * 11;
      const lifeRegainedHr = Math.floor(lifeRegainedMin / 60);
      const lifeRegainedMinRest = lifeRegainedMin % 60;

      const infoBox = document.getElementById("info");
      infoBox.innerHTML = `
        <h2>Dein Fortschritt</h2>
        <p><strong>Gesparte Zigaretten:</strong> ${totalCigsAvoided}</p>
        <p><strong>Gespartes Geld:</strong> ‚Ç¨ ${totalMoneySaved}</p>
        <p><strong>Zur√ºckgewonnene Lebenszeit:</strong> ${lifeRegainedHr} Stunden ${lifeRegainedMinRest} Minuten</p>
      `;

      const reelsContainer = document.getElementById("reels");
      reelsContainer.innerHTML = "";

      const milestones = [];
      const shortTerm = [
        { title: "Blutdruck sinkt leicht", minutes: 20, description: "Bereits 20 Minuten nach der letzten Zigarette beginnt dein Blutdruck zu sinken." },
        { title: "Puls normalisiert sich", minutes: 30, description: "Der Herzschlag verlangsamt sich und kehrt zu einem normalen Rhythmus zur√ºck." },
        { title: "Kohlendioxidspiegel sinkt", hours: 8, description: "Kohlendioxid im Blut reduziert sich, mehr Sauerstoff kann transportiert werden." },
        { title: "Geruchs- und Geschmackssinn verbessert", days: 2, description: "Diese Sinne regenerieren sich merklich." },
        { title: "Nikotin vollst√§ndig abgebaut", days: 3, description: "Das gesamte Nikotin ist aus dem K√∂rper entfernt." },
        { title: "Lungenfunktion verbessert sich", months: 1, description: "Die Flimmerh√§rchen beginnen sich zu regenerieren." },
        { title: "Herzinfarktrisiko sinkt", months: 1, description: "Das Risiko f√ºr einen Herzinfarkt sinkt." },
        { title: "Jahresmeilenstein erreicht", years: 1, description: "Ein ganzes Jahr rauchfrei ‚Äì gro√üe Leistung!" },
        { title: "Lungenkrebsrisiko halbiert", years: 10, description: "Halbiertes Risiko im Vergleich zu Rauchern." },
        { title: "K√∂rper fast vollst√§ndig regeneriert", years: 15, description: "Viele Sch√§den sind nun repariert." },
      ];

      for (let i = 30; i <= 200; i++) {
        milestones.push({
          title: `Tag ${i}`,
          days: i,
          description: `Du bist seit ${i} Tagen rauchfrei. Dein K√∂rper regeneriert sich weiter ‚Äì bleib dran!`
        });
      }

      const allMilestones = [...shortTerm, ...milestones];

      allMilestones.forEach(m => {
        let percent = 0;
        if (m.minutes) percent = Math.min((diffHours * 60 / m.minutes) * 100, 100);
        else if (m.hours) percent = Math.min((diffHours / m.hours) * 100, 100);
        else if (m.days) percent = Math.min((diffDays / m.days) * 100, 100);
        else if (m.months) percent = Math.min((diffMonths / m.months) * 100, 100);
        else if (m.years) percent = Math.min((diffYears / m.years) * 100, 100);

        const reel = document.createElement("div");
        reel.className = "reel";
        reel.innerHTML = `
          <h3 class="milestone-title">${m.title}</h3>
          <div class="progress-circle" style="background: conic-gradient(#10b981 ${percent}%, #333 ${percent}%);">
            <span>${Math.floor(percent)}%</span>
          </div>
          <p class="milestone-description">${m.description}</p>
          ${percent === 100 ? '<p class="milestone-status">‚úÖ Erreicht!</p>' : ""}
        `;
        reelsContainer.appendChild(reel);
      });
    }
  </script>
</body>
</html>
